function reNumberCategoriesTiles(e){e.find(".category-area").each(function(e){jQuery(this).find("h3 span").html(e+1)})}function reInitWidgetCategoriesTiles(){jQuery(".tm-categories-tiles-form-widget select, .tm-categories-tiles-form-widget input[type=text]").off("change"),jQuery(".tm-categories-tiles-form-widget div.upload-image img").off("click"),jQuery(".tm-categories-tiles-form-widget .upload-image .delete-image-url").off("click"),jQuery(".tm-categories-tiles-form-widget .category-area .delete-category").off("click"),jQuery(".tm-categories-tiles-form-widget .categories .add-category").off("click"),initWidgetCategoriesTiles()}function initWidgetCategoriesTiles(){jQuery(".tm-categories-tiles-form-widget select, .tm-categories-tiles-form-widget input[type=text]").change(function(){jQuery(document).trigger("widget-change")}),jQuery(".tm-categories-tiles-form-widget div.upload-image img").click(function(e){var t=jQuery(this),i=t.parents(".category-area").find(".custom-image-url"),r=t.parents(".category-area").find(".upload-image img"),a=wp.media({title:"Upload a Image",button:{text:"Select"},multiple:!1});a.on("select",function(){var e=a.state().get("selection").first().attributes.url;i.val(e).trigger("change"),r.attr("src",e)}),a.open(),e.preventDefault()}),jQuery(".tm-categories-tiles-form-widget .upload-image .delete-image-url").click(function(){var e=jQuery(this),t=e.parents(".category-area").find(".custom-image-url"),i=e.parents(".category-area").find(".upload-image img"),r=i.attr("default_image");return i.attr("src",r),t.val("").trigger("change"),!1}),jQuery(".tm-categories-tiles-form-widget .category-area .delete-category").click(function(){var e=jQuery(this),t=e.parents(".category-area"),i=e.parents(".tm-categories-tiles-form-widget").find(".categories"),r=parseInt(i.attr("count"),10)-1;i.attr("count",r),t.find("input").trigger("change"),t.remove(),reNumberCategoriesTiles(i),reInitWidgetCategoriesTiles()}),jQuery(".tm-categories-tiles-form-widget .categories .add-category").click(function(){var e=jQuery(this),t=e.parents(".tm-categories-tiles-form-widget").find(".categories"),i=parseInt(t.attr("count"),10)+1,r=e.parents(".tm-categories-tiles-form-widget").find(".category-new"),a=r.clone(),g=a.find(".custom-image-url"),o=a.find(".upload-image img"),c=o.attr("default_image"),n=a.find("select");r.before(a),o.attr("src",c),n.val("1"),g.val(""),t.attr("count",i),a.toggleClass("category-area category-new"),a.find("input").each(function(){var e=jQuery(this),t=e.attr("name");t=t.replace("_new",""),e.attr("name",t)}),a.find("select").each(function(){var e=jQuery(this),t=e.attr("name");t=t.replace("_new",""),e.attr("name",t)}),a.find("h3 span").html(i),a.find("input").trigger("change"),jQuery(document).trigger("widget-change"),reNumberCategoriesTiles(t),reInitWidgetCategoriesTiles()})}jQuery(document).on("widget-updated widget-added ready",initWidgetCategoriesTiles);